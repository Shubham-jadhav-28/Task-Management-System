<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Management System</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

</head>

<body>
    <div class="container mt-4 ">
        <h2 class="mb-4 text-start">Add Task</h2>
        <button type="button" class="btn-close position-absolute top-0 end-0 m-4 mx-5 bg-red aria-label="
            Close"></button>
        <div class="card">
            <div class="card-body">
                <form id="taskForm">
                    <div class="row mb-3 align-items-center">
                        <div class="col-md-2">
                            <label class="form-label">Task Owner:</label>
                        </div>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="owner" placeholder="Enter Name" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label class="form-label">Task Name *</label>
                        </div>
                        <div class="col-md-9">
                            <input type="text"  name="taskname" class="form-control" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label class="form-label">Description</label>
                        </div>
                        <div class="col-md-9">
                            <textarea class="form-control" name="taskName"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2 mb-3">
                            <label class="form-label">Start Date</label>
                        </div>
                        <div class="col-md-9">
                            <input type="date" class="form-control" name="startDate">
                        </div>
                        <div class="col-md-2 mb-3">
                            <label class="form-label">Due Date</label>
                        </div>
                        <div class="col-md-9">
                            <input type="date" class="form-control" name="dueDate">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-2">
                            <label class="form-label">Reminder</label>
                        </div>
                        <div class="col-md-9">
                            <input type="datetime-local" class="form-control"  name="reminder">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-2 mb-3">
                            <label class="form-label">Priority</label>
                        </div>
                        <div class="col-md-9">
                            <select class="form-select"  name="priority">

                                <option value="Moderate">Moderate</option>
                                <option value="High">High</option>
                                <option value="Low">Low</option>


                            </select>
                        </div>
                        <div class="col-md-1 d-flex align-items-center ">
                            <i class="fa-solid fa-plus h-5 mb-2 "></i>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label"  >Status *</label>
                        </div>
                        <div class="col-md-9">
                            <select name="status"  class="form-select" required>
                                <option value="Open">Open</option>
                                <option value="Open">In Progress</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </div>
                        <div class="col-md-1 d-flex align-items-center  ">
                            <i class="fa-solid fa-plus h-5 mb-2 "></i>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 d-flex gap-2">
                            <button type="submit" class="btn btn-primary"><a
                                    href="http://127.0.0.1:5500/index2.html"></a>Submit</button>
                            <button type="button" class="btn btn-primary" id="submitNew"><a
                                    href="http://127.0.0.1:5500/index1.html"></a>Submit and New</button>
                            <button type="button" class="btn btn-secondary">Cancel</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Form Submission
              document.getElementById("taskForm").addEventListener("submit", function(event) {
                    event.preventDefault();

                    const formData = new FormData(this);
                    const data = Object.fromEntries(formData);

                    console.log("Data being sent:", JSON.stringify(data));
                  

                    fetch("http://localhost:3000/add-task", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(data)
                    })
                    .then(response => response.json())
                    .then(result => {
                        console.log("Response:", result); // ðŸ”¹ Debugging step
                        alert(result.message);
                        window.location.href = "index2.html";
                    })
                    .catch(error => console.error("Fetch Error:", error));
                });


            // Submit and New (without redirect)
            const submitNewButton = document.getElementById("submitNew");
            if (submitNewButton) {
                submitNewButton.addEventListener("click", function () {
                    const formData = new FormData(document.getElementById("taskForm"));
                    const data = Object.fromEntries(formData);

                    fetch("http://localhost:3000/add-task", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(data)
                    })
                        .then(response => response.json())
                        .then(result => {
                            alert(result.message);
                            document.getElementById("taskForm").reset(); // Reset form after submission
                        })
                        .catch(error => console.error("Error:", error));
                });
            } else {
                console.error("Error: submitNew button not found in the DOM!");
            }

            console.log(document.getElementById("submitNew"));

        });

    </script>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>